<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/darkly.css">
    <link rel="stylesheet" href="styles/styles.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="script.js"></script>
    <title>R&D - Dashboard</title>
</head>
<body onload="OnAppearing()">
  <nav class="navbar navbar-expand-lg bg-primary" data-bs-theme="dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="https://main.d23gwgub2u9aya.amplifyapp.com/">Detectronic R&D</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarColor01">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a id="DashboardTitle" class="nav-link clickable" id="defaultOpen" onclick="DashboardPress(event, 'Dashboard')">Dashboard
              <span class="visually-hidden">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a id="ReturnsTitle" class="nav-link clickable" onclick="openTab(event, 'Returns','Click')">Returns</a>
          </li>
          <li class="nav-item">
            <a id="TestingTitle" class="nav-link clickable" onclick="openTab(event, 'Testing','Click')">Testing</a>
          </li>
        </ul>
        <form class="d-flex">
          <div class="col"><button class="btn btn-outline-dark" type="submit">Log Out</button></div>
        </form>
      </div>
    </div>
  </nav>
  <div class="container-fluid">
    <!-- Tab content -->
    <div id="Dashboard" class="tabcontent">
      <div class="row">
        <main class="col-md-auto ml-sm-auto col-lg-10 px-md-4">
          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
          </div>
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
              <h1 class="h2">Dashboard</h1>
              <div class="btn-toolbar mb-2 mb-md-0">
                <button type="button" class="btn btn-sm btn-outline-secondary btn-light" style="margin-right:5px;">Export</button>
                <select name="timescalePicker" id="timescale" onchange="DateTimeChange()" style="margin-right:5px;"  class="btn btn-sm btn-outline-secondary btn-light d-flex align-items-center gap-1">
                  <option value="Daily">Daily</option>
                  <option value="Weekly">Weekly</option>
                  <option value="Month">Monthly</option>
                  <option value="Year">Yearly</option>
                </select>
                
                <div class="btn-group me-2 align-right btn-toolbar mb-2 mb-md-0">
                  <button id="TestingDBButton" type="button" class="btn btn-sm btn-outline-secondary btn-light" onclick="TestReturnPress('Testing')">Testing</button>
                  <button id="ReturnsDBButton" type="button" class="btn btn-sm btn-outline-secondary btn-light" onclick="TestReturnPress('Returns')">Returns</button>
                </div>
              </div>
            </div>
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
              <h2 >Device Breakdown</h2>
              <h3 id="ChartError" style="display: block;">Data Failed to Display</h3>
            </div>
            <div id="ChartDiv" style="background-color: lightgray; border-radius: 25px;">
              <canvas id="TestHistoryChart" style="max-width:550px;display:inline-block;margin-top:10px; margin-bottom:10px;margin-left:2%;"></canvas>
              <canvas id="DeviceTypeChart" style="max-width:550px;display:inline-block;margin-top:10px; margin-bottom:10px;"></canvas>
              <canvas id="PassFailChart" style="max-width:550px;display:inline-block;margin-top:10px; margin-bottom:10px;margin-left:20px;margin-right:20px"></canvas>
            </div>
            
            <div style="width:100%;float:inline-start;margin-top:20px">
              <h2>Recent Tests</h2>
              <div class="table-responsive small">
                <table class="table table-striped table-sm">
                  <thead>
                    <tr>
                      <th scope="col">Test Time</th>
                      <th scope="col">Serial Number</th>
                      <th scope="col">IMEI</th>
                      <th scope="col">Device </th>
                      <th scope="col">Pass/Fail</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>13:25 28-08-2025</td>
                      <td>1342390003604</td>
                      <td>3559399156480</td>
                      <td>Alarm</td>
                      <td>Pass</td>
                    </tr>                   
                  </tbody>
                </table>
              </div>
          </main>
        </div>
      </div>
    </div>
    
    <div id="Returns" class="tabcontent">
      <div class="row">
        <main class="col-md-auto ml-sm-auto col-lg-10 px-md-4">
          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
            <h1>Returns</h1>
          </div>
          
          <h2>Unit Details</h2>
          <form id="ReturnsForm">
            <div class="row">
              <div class="col-md-3"> 
                <label for="SerialNumber">Serial Number:</label>
                <input type="text" class="form-control" id="SerialNumber">
                <label for="History">Device History:</label>
                <select class="form-control" id="History">
                  <option value="NONE"></option>
                  <option value="CUSTOMER">Customer</option>
                  <option value="CEM Return">CEM Return</option>
                  <option value="Other">Other (See Comments)</option>
                </select>
                <label for="IMEI">IMEI:</label>
                <input type="text" class="form-control" id="IMEI">
                <label for="BatterySerial">Battery Serial:</label>
                <input type="text" class="form-control" id="BatterySerial">
                <label for="BatteryVoltage">Battery Voltage:</label>
                <input type="text" class="form-control" id="BatteryVoltage">
                <label for="FaultCategory">Fault Category:</label>
                <select class="form-control" id="FaultCategory">
                  <option value="NONE"></option>
                  <option value="ANTENNA ISSUE">Antenna</option>
                  <option value="BATTERY ISSUE">Battery</option>
                  <option value="CONFIG ISSUE">Config</option>
                  <option value="DAMAGED">Damaged</option>
                  <option value="DISTANCE MEASUREMENT">Distance</option>
                  <option value="HLC">HLC</option>
                  <option value="MODEM ISSUE">Modem</option>
                  <option value="NFF">No Fault Found</option>
                  <option value="SETTINGS ISSUE">Settings</option>
                  <option value="SIM ISSUE">Sim</option>
                  <option value="TELIT">Telit</option>
                  <option value="WEAR AND TEAR">Wear and Tear</option>
                  <option value="WONT WAKE">Won't Wake</option>
                </select>
                <label for="ReturnReason">Reason For Return:</label>
                <select class="form-control" id="ReturnReason">
                  <option value="NONE"></option>
                  <option value="No Reason Given">No Reason Given</option>
                  <option value="Connection Issues">Connection Issues</option>
                  <option value="Damaged">Damaged</option>
                  <option value="Distance Measurement Issues">Distance Measurement Issues</option>
                  <option value="Low Voltage">Low Voltage</option>
                  <option value="Swapped">Swapped</option>
                  <option value="Wire Broken">Wire Broken</option>
                  <option value="Won't Wake Up">Won't Wake Up</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="Product">Product:</label>
                <select class="form-control" id="Product" onchange=ProductSelect(Product)>
                  <option value="NONE"></option>
                  <option value="LIDoTT ALARM">Alarm</option>
                  <option value="LIDoTT SMART V1">Smart V1</option>
                  <option value="LIDoTT SMART V2">Smart V2</option>
                </select>
                <label for="ProductVariant">Product:</label>
                <select class="form-control" id="ProductVariant" onchange=ProductSelect(Product)>
                  <option value="NONE"></option>
                  <option value="A">A Variant</option>
                  <option value="B">B Variant</option>
                  <option value="C">C Variant</option>
                  <option value="D">D Variant</option>
                </select>
                <label for="ProductCode">Product Code:</label>
                <input type="text" class="form-control" id="ProductCode">
                <label for="Tags">Tag(s):</label>
                <input type="text" class="form-control" id="Tags">
                <label for="DateReturned">Date Returned:</label>
                <input type="datetime-local" class="form-control" id="DateReturned">
                <label for="Customer">Customer:</label>
                <input type="text" class="form-control" id="Customer">
                <label for="FixApplied">Fix Applied:</label>
                <select class="form-control" id="FixApplied">
                  <option value="NONE"></option>
                  <option value="NFF">No Fault Found</option>
                  <option value="CONFIG UPDATE">Config Update</option>
                  <option value="FIRMWARE UPDATE">Firmware Update</option>
                  <option value="MODEM UPDATE">Modem Update</option>
                  <option value="MODEM FIX">Modem Fix</option>
                  <option value="REPLACED ANTENNA">Replaced Antenna</option>
                  <option value="RESET PG">Reset PG</option>
                  <option value="TELIT">Telit</option>
                  <option value="TIGHTENED ANTENNA">Tightened Antenna</option>
                  <option value="UNBOOTSTRAPPED">Un/Re-Bootstrapped</option>
                </select>
              </div>
              <div class="col-md-3">  
                <label for="VisualInspection">Visual Inspection:</label>
                <select class="form-control" id="VisualInspection">
                  <option value="NONE"></option>
                  <option value="PASS">Pass</option>
                  <option value="FAIL">Fail</option>
                </select>
                <label for="VisualComments">Visual Comments:</label>
                <input type="text" class="form-control" id="VisualComments">
                <label for="CommsTest">Comms Test:</label>
                <select class="form-control" id="CommsTest">
                  <option value="NONE"></option>
                  <option value="PASS">Pass</option>
                  <option value="FAIL">Fail</option>
                </select>
                <label for="CommsError">Comms Error:</label>
                <input type="text" class="form-control" id="CommsError">
                <label for="SensorTest">Sensor Test:</label>
                <select class="form-control" id="SensorTest">
                  <option value="NONE"></option>
                  <option value="PASS">Pass</option>
                  <option value="FAIL">Fail</option>
                </select>
                <label for="SensorError">Sensor Error:</label>
                <input type="text" class="form-control" id="SensorError">
                <label class="label" for="Status">Final Status:</label>
                <select class="form-control" id="Status">
                  <option value="NONE"></option>
                  <option value="PASS">Pass</option>
                  <option value="FAIL">Fail</option>
                </select>
              </div>              
            </div>
            <label for="Comments" class="form-label">Comments</label>
            <textarea class="form-control col-md-9" id="Comments" rows="4"></textarea>
            <button id="submitReturnsUnitDetails" type="button" class="btn btn-primary form-control col-md-6" onclick="ReturnsAPIFormat(ReturnsForm); this.blur();">Submit</button>
            <button id="clearReturnsForm" type="button" class="btn btn-primary form-control col-md-3" onclick="ReturnsForm.reset(); this.blur();">Clear Form</button>
          </form>
          <h2>Get Unit Details</h2>
          <div class="row">
        <form id="ReturnsGet">
          <div class="row">
            <div class="col-md-3">
              <label for="ReturnsFilter" class="form-label">Filter Type:</label>
              <select id="ReturnsFilter" class="form-control">
                  <option value="SerialNumber">Serial Number</option>
                  <option value="BatterySerial">Battery Serial</option>
                  <option value="IMEI">IMEI</option>
                  <option value="FailState">Fail State</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="ReturnsFilterInput" class="form-label">Filter By:</label>
              <input type="text" id="ReturnsFilterInput" class="form-control">
            </div>
            <div class="col-md-3">
              <label for="getTestDetailsButton" class="form-label">Get Data:</label>
              <button id="getTestDetailsButton" type="button" class="btn btn-primary form-control bottom" onclick="getReturnsFilterAPI(ReturnsFilter,ReturnsFilterInput)">Get Results</button>
            </div>
          </div>
        </form>
        <table id="UnListReturn" class="table table-bordered table-responsive table-hover table-sm table-dark" width="900" height="1000"></table>
      </main>
      </div>
    </div>
    
    <div id="Testing" class="tabcontent">
      <div class="row">
      <main>
        <div class="col-md-auto ml-sm-auto col-lg-10 px-md-4">
          <h1  class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">Test Data</h1>

        <h2>Testing Manual Entry</h2>
        <form id="TestForm">
          <div class="row">
            <div class="col-md-3">
              <label for="SerialNumber">Serial Number:</label>
              <input type="number" class="form-control" id="SerialNumber">
              <label for="IMEI">IMEI:</label>
              <input type="number" class="form-control" id="IMEI">
              <label for="BatterySerial">Battery Serial:</label>
              <input type="number" class="form-control" id="BatterySerial">
              <label for="BatteryVoltage">Battery Voltage:</label>
              <input type="text" class="form-control" id="BatteryVoltage">
              <label for="DeviceName">Device Name:</label>
              <input type="text" class="form-control" id="DeviceName">
              <label for="DateOfTest">Date of Test:</label>
              <input type="datetime-local" class="form-control" id="DateOfTest">
              <label for="WS46Plus">WS46+ Settings:</label>
              <input type="text" class="form-control" id="WS46Plus">
              <label for="Bootstrapped">Bootstrap Time:</label>
              <input type="datetime-local" class="form-control" id="Bootstrapped">
              <label for="ATEX">Pass/Fail: *</label>
              <select class="form-control" id="ATEX">
                <option class="option" value="NONE"></option>
                <option class="option" value="PASS">Pass</option>
                <option class="option" value="FAIL">Fail</option>
              </select>
            </div>
            <div class="col-md-3">  
              <label for="PrimaryDistance">First Distance:</label>
              <input type="number" class="form-control" id="PrimaryDistance">
              <label for="SecondaryDistance">Second Distance:</label>
              <input type="number" class="form-control" id="SecondaryDistance">
              <label for="TertiaryDistance">Third Distance</label>
              <input type="number" class="form-control" id="TertiaryDistance">
              <label for="ModbusOffset">Modbus Offset:</label>
              <input type="number" class="form-control" id="ModbusOffset">
              <label for="ModemVersion">Modem Version:</label>
              <input type="text" class="form-control" id="ModemVersion">
              <label for="FirmwareVersion">Firmware Version:</label>
              <input type="text" class="form-control" id="FirmwareVersion">
              <label for="WS46Hash">WS46# Settings:</label>
              <select class="form-control" id="WS46Hash">
                <option class="option" value="NONE"></option>
                <option class="option" value="CAT-M1 Only (0)">CAT-M1 Only (0)</option>
                <option class="option" value="NB-IoT Only (1)">NB-IoT Only (1)</option>
                <option class="option" value="CAT-M1 Preferred (2)">CAT-M1 Only (2)</option>
                <option class="option" value="NB-IoT Preferred (3)">NB-IoT Preferred (3)</option>
              </select>
              <label for="Registered">Registration Time:</label>
              <input type="datetime-local" class="form-control" id="Registered">
              <label for="FailReason">Fail Reason:</label>
              <input type="text" class="form-control" id="FailReason">
            </div>
            <div class="col-md-3">  
              <label for="LastAttemptedSend" class="form-label">Last Attempted Send:</label>
              <input type="datetime-local" id="LastAttemptedSend" class="form-control">
              <label for="LastSuccessfulSend">Last Successful Send:</label>
              <input type="datetime-local" id="LastSuccessfulSend" class="form-control">
              <label for="Coordinates">Coordinates:</label>
              <input type="text" class="form-control" id="Coordinates">
              <label for="MobileNetwork">Mobile Network:</label>
              <input class="form-control" id="MobileNetwork">
              <label for="ConnectionType">Connection Type:</label>
              <select class="form-control" id="ConnectionType">
                <option class="option" value="NONE"></option>
                <option class="option" value="CAT-M1">CAT-M1</option>
                <option class="option" value="GSM">GSM</option>
                <option class="option" value="NB-IOT">NB-IOT</option>
              </select>
              <label for="RSSI">RSSI:</label>
              <input type="number" class="form-control" id="RSSI">
              <label for="Exec">Exec Time:</label>
              <input type="datetime-local" class="form-control" id="Exec">
              <label for="CompetentPerson">Competent Person:</label>
              <input type="text" class="form-control" id="CompetentPerson">
              <label for="PointOfOrigin">Point Of Origin:</label>
              <input type="text" class="form-control" placeholder="Production" id="PointOfOrigin">
            </div>
          </div>
        </form>
        <button id="submitTestUnitDetails" type="button" class="btn btn-primary form-control mt-4 col-md-6" onclick="TestingAPIFormat(TestForm); TestForm.reset(); this.blur()">Submit</button>
        <button id="clearTestingButton" type="button" class="btn btn-primary form-control mt-4 col-md-3" onclick="TestForm.reset(); this.blur()">Clear Form</button>
        <div class="pt-2 pb-2 mb-3 "></div>
        
        
        <h2>Testing Upload</h2>
        <form>
          <input type="file" id="fileInput" accept=".csv" />
          <pre id="output"></pre>
      </form>
        <h2>Get Unit Details</h2>
        <form id="TestForm">
          <div class="row">
            <div class="col-md-3">
              <label for="TestFilter" class="form-label">Filter Type:</label>
              <select id="TestFilter" class="form-control">
                  <option value="SerialNumber">Serial Number</option>
                  <option value="BatterySerial">Battery Serial</option>
                  <option value="IMEI">IMEI</option>
                  <option value="FailState">Fail State</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="TestFilterInput" class="form-label">Filter By:</label>
              <input type="text" id="TestFilterInput" class="form-control">
            </div>
            <div class="col-md-3">
              <label for="getTestDetailsButton" class="form-label">Get Data:</label>
              <button id="getTestDetailsButton" type="button" class="btn btn-primary form-control bottom" onclick="getTestingFilterAPI(TestFilter,TestFilterInput)">Get Results</button>
            </div>
          </div>
        </form>
      </div>
      <div class="pt-2 pb-2 mb-3 "></div>
        <table id="UnListTest" class="table table-bordered table-responsive table-hover table-sm table-dark" width="900" height="1000"></table>
      </main>
      </div>
    </div>
  </div>   
</body>
</html>